[core]
name: D_Factory
displayText: Cyber-Plant 
displayDescription: -Creates mechanically enhanced units. \n-Armed with laser defences. \n-Can target orbital units.
class: CustomUnitMetadata
price: 4500
maxHp: 1250
mass: 9000




tags: Turret, Building, Factory, AA, AG, NoCap, LD

copyFrom: ROOT:Dardarndroes/Resource.ini



disableAllUnitCollisions: true




#footprint used for collisions with units (left, up, right, down)
footprint: -1,-1,1,1

#used for placement, and placement of other buildings
constructionFootprint: -1,-1,1,3



buildingToFootprintOffsetX:10
buildingToFootprintOffsetY:0

#tags: anti-orbital

selfRegenRate:0.2


techLevel: 1
buildSpeed: 0.001
#availableInDemo: true
selfBuildRate: 0.0005
radius: 50
#displayRadius: 80
isBio: false
isBuilding: true

energyMax: 1
energyRegen: 0.0009
energyNeedsToRechargeToFull: true

#armour: 2

unitsSpawnedOnDeath: D_Blob

exit_x: 0
exit_y: -1

softCollisionOnAll: 3

#builtFrom_1_name: landFactory
#builtFrom_1_pos:  5



[hiddenAction_Started]
takeResources: ETurret=-1, ELD=-2
[hiddenAction_Started_UpdateAlly]
takeResources: TotalUnit=0
[hiddenAction_Killed]
takeResources: ETurret=1, ELD=2
[hiddenAction_Killed_UpdateAlly]
takeResources: TotalUnit=0
#TotalUnit=-1



[canBuild_rally]
name: setRally
pos: -1
#isLocked: false
#isLockedMessage: NONE
#isGuiBlinking: if not self.hasUnitInTeam(withTag='anti-orbital', greaterThan=0, withinRange=1000)

[canBuild_1]
name: D_Scavanger
pos: 1
isLocked: if self.hasUnitInTeam(withTag='builder', greaterThan=35)

[canBuild_Shell]
name: D_ShellScavanger
pos: 1
isLocked: if not self.hasResources(Shell=1)
price: credits=6000, Data=100


[canBuild_2]
name: D_Nano
pos: 2
isLocked: if not self.hasResources(Nano=1) or self.isControlledByAI() and not self.hasUnitInTeam(withTag='Q_LD', greaterThan=0) and not self.hasUnitInTeam(withTag='Q_AntiStealth', greaterThan=0) and not self.hasUnitInTeam(withTag='Q_Air', greaterThan=0) and self.hasUnitInTeam(withTag='Unit', greaterThan=5)

[canBuild_3]
name: D_Roller
pos: 3
isLocked: if not self.hasResources(Roll=1) or self.isControlledByAI() and not self.hasUnitInTeam(withTag='Q_Land', greaterThan=0) and self.hasUnitInTeam(withTag='Unit', greaterThan=5)

[canBuild_4]
name: D_Sniper
pos: 4
isLocked: if not self.hasResources(Sniper=1) or self.isControlledByAI() and not self.hasUnitInTeam(withTag='Q_Land', greaterThan=0) and self.hasUnitInTeam(withTag='Unit', greaterThan=5) or self.isControlledByAI() and not self.hasUnitInTeam(withTag='Q_Range', greaterThan=0) and not self.hasUnitInTeam(withTag='Q_AntiStealth', greaterThan=0) and not self.hasUnitInTeam(withTag='Q_Subs', greaterThan=0)

[canBuild_5]
name: D_Goliath
pos: 5
isLocked: if not self.hasResources(Gol=1) or self.isControlledByAI() and not self.hasUnitInTeam(withTag='Q_Land', greaterThan=0) and self.hasUnitInTeam(withTag='Unit', greaterThan=5) or self.isControlledByAI() and not self.hasUnitInTeam(withTag='Q_AntiShield', greaterThan=0) and not self.hasUnitInTeam(withTag='Q_AA', greaterThan=0)


[canBuild_6]
name: D_ClusterBird
pos: 6
isLocked: if not self.hasResources(Cluster=1) or self.isControlledByAI() and not self.hasUnitInTeam(withTag='Q_Air', greaterThan=0) and self.hasUnitInTeam(withTag='Unit', greaterThan=5)




[hiddenAction_FinishBuild]
buildSpeed: 0.1s
addResources: unsetFlag=1

# or self.isControlledByAI() and self.numberOfUnitsInTeam(withTag='NeedFix', withinRange=500) > self.numberOfUnitsInTeam(withTag='builder', withinRange=600) and self.hasResources(credits=5000) and not self.hasResources(Shell=1) and not self.hasUnitInTeam(withTag='builder', greaterThan=50) and self.hasResources(Data=500)

[hiddenAction_builder1]
autoTrigger: if self.isControlledByAI() and not self.hasUnitInTeam(withTag='builder', greaterThan=1, withinRange=500) and not self.hasUnitInTeam(withTag='builder', greaterThan=30) and self.hasResources(credits=2000) and not self.hasFlag(id=1) or self.isControlledByAI() and self.numberOfUnitsInTeam(withTag='NeedFix', withinRange=500) > self.numberOfUnitsInTeam(withTag='builder', withinRange=600) and self.hasResources(credits=5000) and not self.hasResources(credits=25000) and not self.hasUnitInTeam(withTag='builder', greaterThan=50) and not self.hasFlag(id=1)
alsoQueueAction: builder2
addResources: setFlag=1, credits=-120

[hiddenAction_builder2]
buildSpeed: 6s
#addResources: credits=-120
alsoQueueAction: FinishBuild
spawnUnits: D_Scavanger


[hiddenAction_builder3]
autoTrigger: if self.isControlledByAI() and not self.hasUnitInTeam(withTag='builder', greaterThan=1, withinRange=500) and self.hasResources(credits=25000, Data=1000) and not self.hasFlag(id=1) and not self.hasUnitInTeam(withTag='builder', greaterThan=40) and self.hasResources(Shell=1) or self.isControlledByAI() and self.numberOfUnitsInTeam(withTag='NeedFix', withinRange=500) > self.numberOfUnitsInTeam(withTag='builder', withinRange=600) and self.hasResources(credits=25000, Data=1000) and not self.hasUnitInTeam(withTag='builder', greaterThan=30) and not self.hasFlag(id=1) and self.hasResources(Shell=1)
alsoQueueAction: builder4
addResources: setFlag=1, credits=-6000, Data=-100

[hiddenAction_builder4]
buildSpeed: 50s
#addResources: credits=-120
alsoQueueAction: FinishBuild
spawnUnits: D_ShellScavanger





[hiddenAction_QuotaLD]
autoTrigger: if self.isControlledByAI() and self.hasUnitInTeam(withTag='Q_LD', greaterThan=0) and self.hasResources(Nano=1) and self.hasResources(credits=45000) and not self.hasFlag(id=1) or self.isControlledByAI() and self.hasUnitInTeam(withTag='Q_Air', greaterThan=0) and self.hasUnitInTeam(withTag='Q_AntiStealth', greaterThan=0) and self.hasResources(Nano=1) and self.hasResources(credits=10000) and not self.hasFlag(id=1)
alsoQueueAction: QuotaLD2
addResources: setFlag=1, credits=-300

[hiddenAction_QuotaLD2]
buildSpeed: 6s
alsoQueueAction: FinishBuild
spawnUnits: D_Nano



[hiddenAction_Range]
autoTrigger: if self.isControlledByAI() and self.hasUnitInTeam(withTag='Q_Range', greaterThan=0) and self.hasResources(credits=25000) and not self.hasFlag(id=1) and self.hasUnitInTeam(withTag='Q_Land', greaterThan=0) and self.hasResources(Sniper=1) or self.isControlledByAI() and self.hasUnitInTeam(withTag='Q_AntiStealth', greaterThan=0) and self.hasResources(credits=14000) and not self.hasFlag(id=1) and self.hasUnitInTeam(withTag='Q_Land', greaterThan=0) and self.hasResources(Sniper=1)
alsoQueueAction: Range2
addResources: setFlag=1, credits=-2200

[hiddenAction_Range2]
buildSpeed: 40s
alsoQueueAction: FinishBuild
spawnUnits: D_Sniper


[hiddenAction_RangeA]
autoTrigger: if self.isControlledByAI() and self.hasUnitInTeam(withTag='Q_Range', greaterThan=0) and self.hasResources(credits=30000) and not self.hasFlag(id=1) and self.hasUnitInTeam(withTag='Q_Air', greaterThan=0) and self.hasResources(Cluster=1)
alsoQueueAction: RangeA2
addResources: setFlag=1, credits=-4500

[hiddenAction_RangeA2]
buildSpeed: 65s
alsoQueueAction: FinishBuild
spawnUnits: D_ClusterBird



[hiddenAction_Gol]
autoTrigger: if self.isControlledByAI() and self.hasUnitInTeam(withTag='Q_AntiShield', greaterThan=0) and self.hasResources(credits=35000) and not self.hasFlag(id=1) and self.hasUnitInTeam(withTag='Q_Land', greaterThan=0) and self.hasResources(Gol=1) or self.isControlledByAI() and self.hasUnitInTeam(withTag='Q_AA', greaterThan=0) and self.hasResources(credits=40000) and not self.hasFlag(id=1) and self.hasUnitInTeam(withTag='Q_Land', greaterThan=0) and self.hasResources(Gol=1)
alsoQueueAction: Gol2
addResources: setFlag=1, credits=-4500

[hiddenAction_Gol2]
buildSpeed: 65s
alsoQueueAction: FinishBuild
spawnUnits: D_Goliath


[hiddenAction_Tank]
autoTrigger: if self.isControlledByAI() and self.hasUnitInTeam(withTag='Q_AntiLD', greaterThan=0) and self.hasResources(credits=20000) and not self.hasFlag(id=1) and self.hasUnitInTeam(withTag='Q_Land', greaterThan=0) and self.hasResources(Roll=1)
alsoQueueAction: Tank2
addResources: setFlag=1, credits=-900

[hiddenAction_Tank2]
buildSpeed: 19s
alsoQueueAction: FinishBuild
spawnUnits: D_Roller




[graphics]
total_frames: 1

image:        factory.png
image_back: base.png
image_wreak:  NONE

#scaleImagesTo: 20
#scaleTurretImagesTo: 9

#AUTO
image_shadow: NONE
shadowOffsetX:1
shadowOffsetY:1




[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits:   true
canAttackUnderwaterUnits: false

turretSize: 20
turretTurnSpeed: 3


maxAttackRange: 250
shootDelay: 100

[turret_1]
x: -8
y: 40
canShoot: false

invisible: true

laserDefenceEnergyUse: 0.09
limitingRange: 250
size:1



[turret_2]
#base
x: -8
y: 40
turnSpeed: 4

canShoot: true
image: eye.png


shoot_sound: plasma_fire
shoot_sound_vol: 0.1
shoot_flame:large
shoot_light:#FFEECCCC

canAttackFlyingUnits: true
canAttackLandUnits:   true
canAttackUnderwaterUnits: false

delay: 15
warmup: 5


[projectile_1]
directDamage: 40
life: 20
speed: 25

laserEffect: true


lightSize: 2
drawSize: 0.3

#ballistic: true
#ballistic_delaymove_height: 10
#ballistic_height: 50


instant:true
largeHitEffect: false

#deflectionPower: 3
shieldDamageMultiplier: 0.2




[movement]
movementType: NONE
moveSpeed: 0
moveAccelerationSpeed: 0.01
moveDecelerationSpeed: 0.01

maxTurnSpeed: 0
turnAcceleration: 0.1



[ai]

buildPriority: 0.21

noneInBaseExtraPriority: 0.39

maxEachBase: 3




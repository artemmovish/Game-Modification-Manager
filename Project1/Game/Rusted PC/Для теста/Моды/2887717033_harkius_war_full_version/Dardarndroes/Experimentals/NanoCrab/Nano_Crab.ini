
[core]
name: D_NanoCrab
displayText: Nano Crab
displayDescription: A powerful crab walker. \n-Can create buildings and nano swarms. \n-Drains credits and data. \n-Provides laser defences. \n-Cannot move over water, despite being crab-like.


class: CustomUnitMetadata
#price: 2
price: 55000

maxHp: 7500
mass: 70000

copyFrom: ROOT:Builder_AI.ini
borrowResourcesWhileAlive: TotalUnit=-1, Ground=-9, Cliff=-9, AG=-3, AA=-3, AntiArmour=-1, LD=-3
tags: Unit, Ground3, Cliff3, AG2, AA2, AntiArmour, CanLead1, builder, CanFollow, NoCap, LD2, Factory




generation_resources: credits=-30, Data=-3
generation_delay: 40
isBuilding: false
techLevel: 1
experimental: true

buildSpeed: 150s
#buildSpeed: 1

armour: 2

#availableInDemo: true

radius: 30
displayRadius: 39


fogOfWarSightRange:15

transportSlotsNeeded: 8

isBio: false
isBuilder: true

softCollisionOnAll: 3

#nanoFactorySpeed:2.5


selfRegenRate:1.2

#builtFrom_1_name: commandCenter
#builtFrom_1_pos:  2

#builtFrom_1_name: experimentalLandFactory
#builtFrom_1_pos:  6

energyMax: 1
energyRegen: 0.007


canRepairBuildings: true
canRepairUnits : true

canReclaimResources: true

autoRepair: true

nanoRange: 270

nanoRepairSpeed: 1
nanoBuildSpeed: 5
nanoFactorySpeed:3



[hiddenAction_Started]
takeResources: EGround=-9, ECliff=-9, EAG=-3, EAA=-3, EAntiArmour=-1, ELD=-3
[hiddenAction_Started_UpdateAlly]
takeResources: Ground=-9, Cliff=-9, AG=-3, AA=-3, AntiArmour=-1, LD=-3
[hiddenAction_Killed]
takeResources: EGround=9, ECliff=9, EAG=3, EAA=3, EAntiArmour=1, ELD=3
[hiddenAction_Killed_UpdateAlly]
takeResources: Ground=9, Cliff=9, AG=3, AA=3, AntiArmour=1, LD=3
#TotalUnit=-1




[global_resource_Data]
displayName: Data
displayRoundedDown: true
displayColor: #8100FF

[global_resource_Orbit]
hidden: true
[global_resource_Maw]
hidden: true
[global_resource_Nuke]
hidden: true
[global_resource_Roll]
hidden: true


[hiddenAction_buildAO]
autoTrigger: if self.isControlledByAI() and self.NumberOfUnitsInTeam(withTag='Q_AO', greaterThan=0) and self.hasResources(credits=30000) and not self.tags(includes='Formation') and not self.tags(includes='Retreat') and not self.tags(includes='Attacking') and not self.tags(includes='DEFEND') and not self.hasActiveWaypoint(type='build')
requireConditional: if self.NumberOfUnitsInTeam(withTag='AOTurret', lessThan=1, withinRange=250) and self.NumberOfUnitsInTeam(withTag='Factory', greaterThan=0, withinRange=250)
addWaypoint_unitType: D_HyperSpitter
addResources: credits=-4800


[canBuild_1]
name: reclaim
pos: -1
#isLocked: false
#isLockedMessage: NONE
#isGuiBlinking: if not self.hasUnitInTeam(withTag='anti-orbital', greaterThan=0, withinRange=1000)

[canBuild_2]
name: D_Hive2, D_Mound2, D_RootNuke, D_Stem, D_StemHub
pos: 1



[canBuild_4]
name: D_Mutation, D_Factory, D_seaFactoryT2
pos: 3


[canBuild_orbit]
name: DarPort
pos: 3
isLocked: if not self.hasResources(Orbit=1)



[canBuild_5]
name: D_nanoturret, D_NetTurret, D_CannonTurret
pos: 4

[canBuild_maw]
name: D_HookTurret
pos: 4
isLocked: if not self.hasResources(Maw=1)



[canBuild_6]
name: D_Megaspore
pos: 5
isLocked: if not self.hasResources(Nuke=1)



[canBuild_7]
name: D_HyperSpitter
pos: 4
isGuiBlinking: if not self.hasUnitInTeam(withTag='anti-orbital', greaterThan=0, withinRange=1000)



[canBuild_8]
name: D_Scavanger
pos:  1
forceNano: false

[canBuild_9]
name: D_Drone4
pos:  1
forceNano: false

[canBuild_10]
name: D_Roller
pos:  1
forceNano: true
isLocked: if not self.hasResources(Roll=1)


[hiddenAction_Healed]
autoTrigger: if self.isControlledByAI() and self.hp(greaterThan=7000)
temporarilyRemoveTags: Retreat

[hiddenAction_Damaged]
autoTrigger: if self.isControlledByAI() and self.hp(lessThan=5000)
temporarilyAddTags: Retreat





[graphics]
drawLayer: experimentals

total_frames: 1

image:        body.png
image_wreak:  corpse.png
image_turret: Nanohose.png
#scaleImagesTo: 20
#scaleTurretImagesTo: 9

#teamColorsOnTurret: true

image_shadow: AUTO
shadowOffsetX:3
shadowOffsetY:3

#repairEffect: CUSTOM:nano1
repairEffectAtTarget: CUSTOM:nano1, CUSTOM:nano2, CUSTOM:nano3
repairEffectRate: 5

#reclaimEffect: CUSTOM:nano1
reclaimEffectAtTarget: CUSTOM:nano3
reclaimEffectRate: 5




[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits:   true
canAttackUnderwaterUnits: false

turretSize: 30
turretTurnSpeed: 2
maxAttackRange: 320
shootDelay: 85

turretMultiTargeting: true

[turret_nanoTurret]

x: 0
y: 2

idleDir:0
#idleDirReversing: -110

warmup:30

turnSpeed: 4
size: 8

canShoot: false
canAttackFlyingUnits: false
canAttackLandUnits:   false
canAttackUnderwaterUnits: false

isMainNanoTurret: true


[turret_laserDefence]
x: 0
y: 2
canShoot: false
invisible: true
laserDefenceEnergyUse: 0.085
limitingRange: 185
size:1


[turret_smallLaser1]
x: 17
y: -22

idleDir:10
idleDirReversing: 170

shoot_sound:cannon_firing
shoot_sound_vol:0.2
shoot_flame:small
shoot_light:#FFccCCEE

image: cannon.png
projectile: laserShot

delay: 35
warmup: 0

size: 32

turnSpeedAcceleration: 0.2
turnSpeed: 5

recoilOffset: -1
recoilOutTime: 3
recoilReturnTime: 4



[turret_smallLaser2]
x: -17
y: -22

idleDir:-10
idleDirReversing: 190

copyFrom: smallLaser1
linkDelayWithTurret:smallLaser1
warmup:10

[projectile_laserShot]
directDamage: 110
life: 80
speed: 12
targetSpeed: 16
targetSpeedAcceleration: 0.7



drawType:2
frame:4
drawSize: 1
trailEffect: CUSTOM:projectileTrail
trailEffectRate:2



lightColor:#ffffff

explodeEffect: smallExplosion, CUSTOM:hitLightFlash, CUSTOM:projectilePassThough



#explodeEffectOnShield: CUSTOM:hitLightFlash

effectOnCreate: CUSTOM:projectileLight





[effect_projectileTrail]
image: SHARED:light_50.png
life: 20
fadeOut: true
attachedToUnit: false
color: #e89263
fadeInTime:2
scaleFrom: 0.4
scaleTo: 0.4
alpha: 0.6
drawUnderUnits:true
#ySpeedRelative:-1


[effect_projectileLight]
priority:veryhigh

image: SHARED:light_50.png
life: 100
fadeOut: true
attachedToUnit: true
color: #e89263
fadeInTime:2
scaleFrom: 0.8
scaleTo: 0.8
alpha: 0.6
drawUnderUnits:false
liveAfterAttachedDies: false

[effect_hitLightFlash]
priority:high

image: SHARED:light_50.png
life: 14
fadeOut: true
attachedToUnit: false
color: #e89263

scaleFrom: 1.8
scaleTo: 1.8
alpha: 0.6
drawUnderUnits:false

[effect_projectilePassThough]

priority:high
frameIndex: 4
stripIndex: projectiles2
life: 20
fadeOut: true
attachedToUnit: false
color: #FFFFFF
scaleFrom: 1
scaleTo: 0.5
alpha: 1
drawUnderUnits:false
ySpeedRelative:2
atmospheric: true




[effect_nano1]
attachedToUnit: true
life: 40
physics: true
xSpeedRelativeRandom: 3
xSpeedRelativeRandom: 3
hSpeed: 1
image: nano1.png
drawUnderUnits:false


[effect_nano2]
attachedToUnit: true
life: 40
physics: true
xSpeedRelativeRandom: 3
xSpeedRelativeRandom: 3
hSpeed: 1
image: nano2.png
drawUnderUnits:false


[effect_nano3]
attachedToUnit: true

life: 40
physics: true
xSpeedRelativeRandom: 3
xSpeedRelativeRandom: 3
hSpeed: 1
image: nano3.png
drawUnderUnits:false





[leg_1]
x: -35
y: 45
attach_x: -20
attach_y: 20
moveSpeed: 4

rotateSpeed: 5

heightSpeed: 1.2
resetAngle:25

image_leg:  leg.png
image_foot: NONE

#draw_foot_on_top: false
#dust_effect: false

#holdDisMin: 0.02
#holdDisMax: 0.04

[leg_2]
x: 35
y: 45
attach_x: 20
attach_y: 20
copyFrom: 1

[leg_3]
x: -40
y: -40
attach_x: -20
attach_y: -20
copyFrom: 1

[leg_4]
x: 40
y: -40
attach_x: 20
attach_y: -20
copyFrom: 1

[leg_5]
x: -45
y: 0
attach_x: -25
attach_y: 0
copyFrom: 1

[leg_6]
x: 45
y: 0
attach_x: 25
attach_y: 0
copyFrom: 1




[effect_lightFlash]
priority:high

image: SHARED:light_50.png
life: 14
fadeOut: true
attachedToUnit: false
color: #63e6e8

scaleFrom: 1.8
scaleTo: 1.8
alpha: 0.6
drawUnderUnits:false




[movement]
movementType: OVER_CLIFF
moveSpeed: 1.2
moveAccelerationSpeed: 0.09
moveDecelerationSpeed: 0.09

targetHeight: 0
targetHeightDrift: 0

reverseSpeedPercentage:0.95

maxTurnSpeed: 1.9
turnAcceleration: 0.25

moveSlidingMode :false
moveIgnoringBody:false
moveSlidingDir:  45


slowDeathFall: true





[ai]
useAsBuilder: true






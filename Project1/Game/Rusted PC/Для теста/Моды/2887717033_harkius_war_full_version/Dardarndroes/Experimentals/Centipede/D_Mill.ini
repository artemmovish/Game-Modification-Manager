
[core]
name: D_Mill
displayText: Millipede segment
displayDescription: A frontline storming unit, fast and deadly. \n-Can split when segments are destroyed. \n-Can cross water and rough terrain. \n -Exceptionally high firepower. \n -Extremely durable. \n-Can target stealth and underwater units.\n-Cannot attack some weaker units.\n-If there isn't a segment behind it, a new one can be built but will drain more economy.
class: CustomUnitMetadata
price: 8000
maxHp: 6000
mass: 400000

#showInEditor: true

generation_resources: credits=-13, Data=-2
generation_delay: 40

copyFrom: ROOT:Unit_AI_Base.ini
borrowResourcesWhileAlive: TotalUnit=-1, Ground=-6, Cliff=-6, Water=-6, AG=-6, AA=-6, AntiArmour=-3, Artillery=-3, AntiLD=-1, Armour=-20, AS=-3, AntiStealth=-1
tags: Unit, Ground3, Cliff3, Water3, AG2, AA2, AntiArmour2, ALD, Range2, Titan, ArmourT, anti-stealth, AS2, AStealth, Milli

techLevel: 2
experimental: true

buildSpeed: 290s
#availableInDemo: true

radius: 25
#displayRadius: 11
isBio: false
softCollisionOnAll: 3

armour: 45


disableAllUnitCollisions: true


fogOfWarSightRange: 26

transportSlotsNeeded: 9999
showActionsWithMixedSelectionIfOtherUnitsHaveTag: Milli




#disableAllUnitCollisions: true

maxTransportingUnits: 0

#energyMax: 3
#energyRegen: 0.0025
#energyNeedsToRechargeToFull: true


selfRegenRate:0.25


nanoFactorySpeed:0.35

canBuild_1_name: D_Drone1
canBuild_1_pos:  0.3



[hiddenAction_Started]
takeResources: EGround=-6, ECliff=-6, EWater=-6, EAG=-6, EAA=-6, EAntiArmour=-3, Artillery=-3, EAntiLD=-1, EArmour=-20, EAS=-3, EAntiStealth=-1
[hiddenAction_Started_UpdateAlly]
takeResources: Ground=-6, Cliff=-6, Water=-6, AG=-6, AA=-6, AntiArmour=-3, Artillery=-3, AntiLD=-1, Armour=-20, AS=-3, AntiStealth=-1
[hiddenAction_Killed]
takeResources: EGround=6, ECliff=6, EWater=6, EAG=6, EAA=6, EAntiArmour=3, Artillery=3, EAntiLD=1, EArmour=20, EAS=3, EAntiStealth=1
[hiddenAction_Killed_UpdateAlly]
takeResources: Ground=6, Cliff=6, Water=6, AG=6, AA=6, AntiArmour=3, Artillery=3, AntiLD=1, Armour=20, AS=3, AntiStealth=1
#TotalUnit=-1




[hiddenAction_builder1]
autoTrigger: if self.isControlledByAI() and self.hasResources(credits=2000) and numberOfUnitsInEnemyTeam(greaterThan=0, withinRange=400) and not self.hasFlag(id=1)
alsoQueueAction: builder2
addResources: setFlag=1, credits=-40

[hiddenAction_builder2]
buildSpeed: 3.2s
#addResources: credits=-500
alsoQueueAction: builder3
spawnUnits: D_Drone1

[hiddenAction_builder3]
buildSpeed: 0.1s
addResources: unsetFlag=1



[hiddenAction_TriggerBuild]
autoTrigger: if self.isControlledByAI() and not self.numberOfAttachedUnits(greaterThan=0) and self.hasResources(credits=100000) and not self.hasFlag(id=1)
alsoQueueAction: trigger_upgrade
addResources: setFlag=1, credits=-7000



[action_trigger_upgrade]
price: 7000
buildSpeed: 7.5s
text: Upgrade
isVisible: true
whenBuilding_cannotMove: false
attachments_addNewUnits: D_MillExtra
attachments_onlyOnSlots: Body1
isLocked: if self.numberOfAttachedUnits(greaterThan=0)
allowMultipleInQueue: false
addResources: unsetFlag=1



[global_resource_Data]
displayName: Data
displayRoundedDown: true
displayColor: #8100FF

[hiddenAction_Healed]
autoTrigger: if self.isControlledByAI() and hasUnitInTeam(withTag='Milli', greaterThan=5, withinRange=200)
temporarilyRemoveTags: Retreat

[hiddenAction_Damaged]
autoTrigger: if self.isControlledByAI() and not hasUnitInTeam(withTag='Milli', greaterThan=4, withinRange=200)
temporarilyAddTags: Retreat




[graphics]
total_frames: 1

teamColorsOnTurret: true
image:        millipede.png
image_wreak:  corpse.png
image_turret: NONE
icon_zoomed_out: MapX.png


image_shadow: AUTO
shadowOffsetX:1
shadowOffsetY:1




[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits:   true
canAttackUnderwaterUnits: true

maxAttackRange: 650
shootDelay: 40

turretRotateWithBody: true
turretMultiTargeting: true
attackMovement: normal





[turret_1]

#right gunning arm

x: 0
y: 0
projectile: 1
invisible: true
turnSpeed: 5
turnSpeedAcceleration: 5


canShoot: true

delay: 0.8s
warmup: 0.2s
invisible: true
limitingRange: 280
canOnlyAttackUnitsWithoutTags: Small




[turret_2]

#right gunning arm

x: 0
y: 0
projectile: 2
invisible: true
turnSpeed: 5
turnSpeedAcceleration: 5


canShoot: true

delay: 3.5s
warmup: 0.5s
invisible: true

shoot_sound: cannon_firing
shoot_sound_vol:0.4
canAttackFlyingUnits: false
canAttackLandUnits:   true
canAttackUnderwaterUnits: true
canOnlyAttackUnitsWithoutTags: Small



[turret_3]

#right gunning arm

x: 0
y: 0
projectile: 3
invisible: true
turnSpeed: 5
turnSpeedAcceleration: 5


canShoot: true

delay: 0.6s
warmup: 0.2s
invisible: true

limitingRange: 280
shoot_sound: plasma_fire
shoot_sound_vol:0.1
shoot_flame:small
shoot_light:#FFEECCCC
canOnlyAttackUnitsWithoutTags: Small






[projectile_1]
directDamage: 30
life: 150
speed: 5

image: shot.png

areaExpandTime: 60

#targetGround: true

areaDamage: 45
areaRadius: 100

largeHitEffect: true
trailEffect: CUSTOM:projectileTrail
trailEffectRate:0.2

explodeEffect: CUSTOM:puddle




[projectile_2]
directDamage: 5
life: 150
speed: 7
spawnUnit: D_CCells

image: spore.png

targetGround: true
targetGroundSpread: 15

areaDamage: 160
areaRadius: 20
initialUnguidedSpeedHeight: 1.2
gravity:0.18
#lightCastOnGround: true
largeHitEffect: true

areaRadiusFromEdge: true




[projectile_3]
directDamage: 50
life: 150
speed: 10


trailEffect: false
image: beam.png



[effect_puddle]
life: 300

priority: high

scaleFrom: 0.1
scaleTo: 1.5

fadeInTime: 2
fadeOut: true

attachedToUnit: true

image: puddle.png

drawUnderUnits: false

alpha:0.8

[effect_projectileTrail]
image: trail.png
life: 25
fadeOut: true
attachedToUnit: false
fadeInTime:1
scaleFrom: 1
scaleTo: 0.5
alpha: 0.6
drawUnderUnits:true
#ySpeedRelative:-1





[attachment_Body1]
x: 0
y: -25
keepAliveWhenParentDies: true
canBeAttackedAndDamaged: true
setDrawLayerOnBottom: true
rotateWithParent: false
isUnselectable: false
lockRotation: false
idleDir: 0
resetRotationWhenNotAttacking: true
deattachIfWantingToMove: false
onCreateSpawnUnitOf: D_Mill1
prioritizeParentsMainTarget: true
lockLegMovement: false






[leg_1]
x: -25
y: 25
attach_x: -5
attach_y: 15
moveSpeed: 5

rotateSpeed: 4

heightSpeed: 1
resetAngle:25

image_leg:  leg.png
image_foot: NONE

#draw_foot_on_top: false
#dust_effect: false



#holdDisMin: 0.005
#holdDisMax: 0.01


[leg_2]
x: 25
y: 25
attach_x: 5
attach_y: 15
copyFrom: 1




[leg_3]
x: -25
y: -10
attach_x: -5
attach_y: -5
moveSpeed: 5

rotateSpeed: 4

heightSpeed: 1
resetAngle:25

image_leg:  leg.png
image_foot: NONE

#draw_foot_on_top: false
#dust_effect: false



#holdDisMin: 0.005
#holdDisMax: 0.01


[leg_4]
x: 25
y: -10
attach_x: 5
attach_y: -5
copyFrom: 1







[movement]
movementType: OVER_CLIFF_WATER
moveSpeed: 1.8
moveAccelerationSpeed: 0.12
moveDecelerationSpeed: 0.12

targetHeight:0.4
targetHeightDrift: 0

maxTurnSpeed: 1.1
turnAcceleration: 0.15

moveSlidingMode :true
moveIgnoringBody:true
moveSlidingDir:  30


slowDeathFall: true







[ai]
ai_upgradePriority: 0.5
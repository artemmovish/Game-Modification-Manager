
[core]
name: D_Lobster
displayText: Lobster Tank
displayDescription: An armoured tank that harvests the ground to make missiles. \n-Can attack land and air. \n-Slow health regen.\n-Missiles fire in bursts. \n-Amphibeous, but slow.
class: CustomUnitMetadata

price: 13000
maxHp: 2000
mass: 50000

copyFrom: ROOT:Unit_AI_Base.ini
borrowResourcesWhileAlive: TotalUnit=-1, Ground=-3, Water=-3, AG=-3, AA=-3, AntiLD=-3, AntiArmour=-3, Shield=-3, Armour=-1, Artillery=-1
tags: Unit, Ground2, Water2, AG2, AA2, ALD2, Armour, AntiArmour2, Shield2, Range

techLevel: 2
experimental: false

buildSpeed: 80s

radius: 30
displayRadius: 25


fogOfWarSightRange: 20


transportSlotsNeeded: 4

armour: 4

isBio: false
selfRegenRate:0.1

energyMax: 8
energyRegen: 0.02
energyNeedsToRechargeToFull: true


maxShield: 1000
shieldRegen: 0.25
shieldDisplayOnlyDeflection: true


[hiddenAction_Started]
takeResources: EGround=-3, EWater=-3, EAG=-3, EAA=-3, EAntiLD=-3, EAntiArmour=-3, EShield=-3, EArmour=-1, EArtillery=-1
[hiddenAction_Started_UpdateAlly]
takeResources: Ground=-3, Water=-3, AG=-3, AA=-3, AntiLD=-3, AntiArmour=-3, Shield=-3, Armour=-1, Artillery=-1
[hiddenAction_Killed]
takeResources: EGround=3, EWater=3, EAG=3, EAA=3, EAntiLD=3, EAntiArmour=3, EShield=3, EArmour=1, EArtillery=1
[hiddenAction_Killed_UpdateAlly]
takeResources: Ground=3, Water=3, AG=3, AA=3, AntiLD=3, AntiArmour=3, Shield=3, Armour=1, Artillery=1
#TotalUnit=-1



[action_trigger_onWater]
autoTrigger: if self.overWater()

convertTo: D_Lobster2
buildSpeed: 0
text: TRIGGER
isVisible: false






[hiddenAction_retreat]
autoTrigger: if self.isControlledByAI() and self.hp(lessThan=1600) and not self.hasActiveWaypoint(type='move') or self.isControlledByAI() and self.energy(lessThan=4) and not self.hasActiveWaypoint(type='move') and not self.hasActiveWaypoint(type='guard')
clearAllWaypoints: false
addWaypoint_prepend: true
addWaypoint_type: move
addWaypoint_target_nearestUnit_maxRange: 9999
addWaypoint_target_nearestUnit_team: own
addWaypoint_target_nearestUnit_tagged: Repair



[hiddenAction_Healed]
autoTrigger: if self.isControlledByAI() and self.hp(greaterThan=1900) and not self.energy(lessThan=6)
temporarilyRemoveTags: Retreat

[hiddenAction_Damaged]
autoTrigger: if self.isControlledByAI() and self.hp(lessThan=1600) or self.isControlledByAI() and self.energy(lessThan=2) 
temporarilyAddTags: Retreat



[effect_thrust]
image: Trail.png
life: 400
fadeOut: true
attachedToUnit: false

drawUnderUnits:true

atmospheric: false





[graphics]
total_frames: 1
teamColorsOnTurret: true
drawLayer: experimentals
image:        Body.png
image_wreak: ruin.png
image_turret: Launcher.png


image_shadow: SHADOW:Body.png
lock_shadow_rotation_with_main_turret: false
shadowOffsetX:2
shadowOffsetY:2


movementEffect: CUSTOM:thrust
movementEffectRate: 20



[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits:   true
canAttackUnderwaterUnits: false

turretSize: 20
turretTurnSpeed: 2
maxAttackRange: 350

shootDelay: 35
aimOffsetSpread:0.5
turretRotateWithBody: true

turretMultiTargeting: false





[turret_Missile]
#missile turret
x: 0
y: 0
barrelX: -8
barrelY: 5
barrelOffsetX_onOddShots: 16
aimOffsetSpread: 80


idleDir:0
turnSpeed: 0
canAttackMaxAngle: 181

invisible: false

shoot_sound:cannon_firing
shoot_sound_vol:0.2
shoot_flame:small
shoot_light:#FFccCCEE


projectile: missile




delay: 0.1s
warmup: 0s

recoilOffset: -3
recoilOutTime: 2
recoilReturnTime: 5


energyUsage: 1





[projectile_missile]
directDamage: 130
life: 30
speed: 2

targetSpeed: 8
targetSpeedAcceleration: 0.3
turnSpeed:3

spawnProjectilesOnEndOfLife: 2



#areaDamage: 60
#areaRadius: 90


#spawnUnit: D_NotSpaceBlob

drawType:2
frame:4
drawSize: 1
#trailEffect: CUSTOM:projectileTrail
trailEffectRate:2



lightColor:#ffffff

explodeEffect: smallExplosion, CUSTOM:hitLightFlash, CUSTOM:projectilePassThough



#explodeEffectOnShield: CUSTOM:hitLightFlash

effectOnCreate: CUSTOM:projectileLight






[projectile_2]
directDamage: 130
life: 200
speed: 8

targetSpeed: 16
targetSpeedAcceleration: 0.7
turnSpeed:12

spawnProjectilesOnEndOfLife: NONE


@copyFromSection: projectile_missile


wobbleAmplitude: 0.15
wobbleFrequency: 0.95s






[effect_projectileTrail]
image: SHARED:light_50.png
life: 20
fadeOut: true
attachedToUnit: false
color: #e89263
fadeInTime:2
scaleFrom: 0.4
scaleTo: 0.4
alpha: 0.6
drawUnderUnits:true
#ySpeedRelative:-1


[effect_projectileLight]
priority:veryhigh

image: SHARED:light_50.png
life: 100
fadeOut: true
attachedToUnit: true
color: #e89263
fadeInTime:2
scaleFrom: 0.8
scaleTo: 0.8
alpha: 0.6
drawUnderUnits:false
liveAfterAttachedDies: false

[effect_hitLightFlash]
priority:high

image: SHARED:light_50.png
life: 14
fadeOut: true
attachedToUnit: false
color: #e89263

scaleFrom: 1.8
scaleTo: 1.8
alpha: 0.6
drawUnderUnits:false



[effect_projectilePassThough]

priority:high
frameIndex: 4
stripIndex: projectiles2
life: 20
fadeOut: true
attachedToUnit: false
color: #FFFFFF
scaleFrom: 1
scaleTo: 0.5
alpha: 1
drawUnderUnits:false
ySpeedRelative:2
atmospheric: true








[movement]
movementType: HOVER
moveSpeed: 0.8
moveAccelerationSpeed: 0.04
moveDecelerationSpeed: 0.04

maxTurnSpeed: 0.7
turnAcceleration: 0.1
targetHeight:3
moveSlidingMode :true
moveIgnoringBody:true
moveSlidingDir:  10
reverseSpeedPercentage:0.8

#slowDeathFall: true

